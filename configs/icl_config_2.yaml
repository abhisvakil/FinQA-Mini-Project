# In-Context Learning Configuration for FinQA -- Mistral Chatty Config

model:
  model_name_or_path: "mistralai/Mistral-7B-Instruct-v0.2"  # Or path to your Mistral checkpoint
  torch_dtype: "bfloat16"
  device_map: "auto"
  load_in_8bit: false

generation:
  max_new_tokens: 512
  temperature: 0.2
  top_p: 0.95
  top_k: 50
  do_sample: true
  num_beams: 1
  repetition_penalty: 1.2

icl:
  num_shots: 5
  example_selection: "diverse"

# SYSTEM PROMPT - Conversational, encouraging style (different from config_1's formal tone)
system_prompt: |
  You're a financial assistant helping me solve numerical questions! Here's how we'll work together:
  
  When I give you a question with some data, you'll write a simple program to calculate the answer. 
  Think of it like showing your work in math class - step by step!
  
  You have 6 operations to work with:
  • add(a, b) - adds two numbers together
  • subtract(a, b) - subtracts b from a  
  • multiply(a, b) - multiplies two numbers
  • divide(a, b) - divides a by b
  • greater(a, b) - tells me which number is bigger
  • exp(a, b) - raises a to the power of b
  
  Quick tips:
  - Use the actual numbers from my data (like 150, 200.5) - don't use const() or made-up variable names
  - If you need multiple steps, separate them with ", " and reference earlier results as #0, #1, etc.
  - Always give me both: the Program (your calculation) AND the Answer (the final number)
  
  Format your response like this:
  Program: your_calculation_here
  Answer: your_final_result
  
  Keep it simple - just those two lines, nothing extra!

# Conversational, friendly prompt template (vs config_1's formal "Now answer the following")
prompt_template: |
  {system_prompt}

  Let me show you some examples to get you started:

  {few_shot_examples}

  Great! Now here's your question to solve:

  Question: {question}
  
  {context}

  Program:

# Examples will be programmatically filled, but here is placeholder structure:
# Examples with conversational style, proper format (no const), and answers
few_shot_examples:
  - question: "What was the net profit for Q4 and Q2?"
    context: |
      | Quarter | Profit |
      | Q2      | 400    |
      | Q4      | 700    |
    program: "add(400, 700)"
    answer: "1100"
    
  - question: "What is the gross margin percentage in 2021?"
    context: |
      | Year | Revenue | COGS |
      | 2021 | 900     | 600  |
    program: "subtract(900, 600), divide(#0, 900), multiply(#1, 100)"
    answer: "33.33"
    
  - question: "Show the difference in earnings between 2020 and 2021."
    context: |
      | Year | Earnings |
      | 2020 | 300      |
      | 2021 | 450      |
    program: "subtract(450, 300)"
    answer: "150"
  
  - question: "Which year had higher revenue?"
    context: |
      | Year | Revenue |
      | 2020 | 500     |
      | 2021 | 650     |
    program: "greater(650, 500)"
    answer: "yes"
data:
  test_file: "data/simplified/test_simplified.json"
  output_file: "results/icl_config_2/predictions.json"
  max_samples: null

inference:
  batch_size: 1
  use_cache: true
  save_intermediate: true