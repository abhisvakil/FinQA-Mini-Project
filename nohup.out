[0;34m============================================================[0m
[0;34m       FinQA PEFT vs ICL - Complete Pipeline[0m
[0;34m============================================================[0m

[1;33m[INFER] ICL Mistral with config_1...[0m
================================================================================
UNIFIED ICL INFERENCE FOR FINQA
================================================================================
Config: ../configs/icl_config_1.yaml
Model: mistralai/Mistral-7B-Instruct-v0.2
Few-shot examples: 5
Temperature: 0.2
Output: ../results/predictions
================================================================================

[1/5] Loading model and tokenizer...
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:00<00:01,  1.11it/s]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:01<00:00,  1.01it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:02<00:00,  1.10it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:02<00:00,  1.08it/s]
  Model loaded on device: cuda:0

[2/5] Loading data...
  Train examples: 6251
  Test examples: 1147

[3/5] Selecting and formatting few-shot examples...
  Example 1: how much of the oil production is estimated to be produced f...
  Example 2: for 2017 , the estimated impact of tax legislation was what ...
  Example 3: how many new sites were in the us during 2012 to 2014?\\n...
  Example 4: what percent of total contractual obligations is due to purc...
  Example 5: what was the percent of growth in gross profit from 2004 to ...

[4/5] Running inference...
Running ICL inference:   0%|                                               | 0/1147 [00:00<?, ?it/s]Running ICL inference:   0%|                                     | 1/1147 [00:07<2:23:23,  7.51s/it]Running ICL inference:   0%|                                     | 2/1147 [00:09<1:22:50,  4.34s/it]Running ICL inference:   0%|                                     | 3/1147 [00:11<1:04:58,  3.41s/it]Running ICL inference:   0%|â–                                      | 4/1147 [00:13<54:02,  2.84s/it]Running ICL inference:   0%|â–                                    | 5/1147 [00:19<1:14:38,  3.92s/it]Running ICL inference:   1%|â–                                    | 6/1147 [00:28<1:45:32,  5.55s/it]Running ICL inference:   1%|â–                                    | 7/1147 [00:30<1:23:33,  4.40s/it]Running ICL inference:   1%|â–Ž                                    | 8/1147 [00:33<1:13:39,  3.88s/it]Running ICL inference:   1%|â–Ž                                    | 9/1147 [00:35<1:01:25,  3.24s/it]Running ICL inference:   1%|â–Ž                                   | 10/1147 [00:45<1:43:46,  5.48s/it]Running ICL inference:   1%|â–Ž                                   | 11/1147 [00:51<1:44:56,  5.54s/it]Running ICL inference:   1%|â–                                   | 12/1147 [00:53<1:28:00,  4.65s/it]Running ICL inference:   1%|â–                                   | 13/1147 [00:56<1:16:23,  4.04s/it]Running ICL inference:   1%|â–                                   | 14/1147 [00:58<1:04:17,  3.40s/it]Running ICL inference:   1%|â–                                   | 15/1147 [01:01<1:00:55,  3.23s/it]Running ICL inference:   1%|â–Œ                                   | 16/1147 [01:07<1:16:43,  4.07s/it]Running ICL inference:   1%|â–Œ                                   | 17/1147 [01:17<1:53:52,  6.05s/it]Running ICL inference:   2%|â–Œ                                   | 18/1147 [01:23<1:53:24,  6.03s/it]Running ICL inference:   2%|â–Œ                                   | 19/1147 [01:31<1:59:50,  6.37s/it]Running ICL inference:   2%|â–‹                                   | 20/1147 [01:37<1:58:30,  6.31s/it]Running ICL inference:   2%|â–‹                                   | 21/1147 [01:40<1:38:41,  5.26s/it]Running ICL inference:   2%|â–‹                                   | 22/1147 [01:44<1:31:47,  4.90s/it]Running ICL inference:   2%|â–‹                                   | 23/1147 [01:51<1:48:28,  5.79s/it]Running ICL inference:   2%|â–Š                                   | 24/1147 [01:54<1:30:01,  4.81s/it]Running ICL inference:   2%|â–Š                                   | 25/1147 [01:58<1:24:11,  4.50s/it]Running ICL inference:   2%|â–Š                                   | 26/1147 [02:00<1:11:39,  3.84s/it]Running ICL inference:   2%|â–Š                                   | 27/1147 [02:02<1:02:21,  3.34s/it]Running ICL inference:   2%|â–‰                                   | 28/1147 [02:06<1:03:22,  3.40s/it]Running ICL inference:   3%|â–‰                                   | 29/1147 [02:09<1:03:32,  3.41s/it]Running ICL inference:   3%|â–‰                                   | 30/1147 [02:12<1:01:34,  3.31s/it]Running ICL inference:   3%|â–ˆ                                     | 31/1147 [02:15<55:47,  3.00s/it]Running ICL inference:   3%|â–ˆ                                     | 32/1147 [02:18<59:01,  3.18s/it]Running ICL inference:   3%|â–ˆ                                     | 33/1147 [02:21<55:53,  3.01s/it]Running ICL inference:   3%|â–ˆ                                   | 34/1147 [02:31<1:35:15,  5.14s/it]Running ICL inference:   3%|â–ˆ                                   | 35/1147 [02:34<1:23:57,  4.53s/it]Running ICL inference:   3%|â–ˆâ–                                  | 36/1147 [02:38<1:20:02,  4.32s/it]Running ICL inference:   3%|â–ˆâ–                                  | 37/1147 [02:40<1:08:50,  3.72s/it]Running ICL inference:   3%|â–ˆâ–                                  | 38/1147 [02:42<1:01:04,  3.30s/it]Running ICL inference:   3%|â–ˆâ–Ž                                    | 39/1147 [02:45<58:28,  3.17s/it]Running ICL inference:   3%|â–ˆâ–Ž                                  | 40/1147 [02:51<1:12:13,  3.91s/it]Running ICL inference:   4%|â–ˆâ–Ž                                  | 41/1147 [02:53<1:01:52,  3.36s/it]Running ICL inference:   4%|â–ˆâ–Ž                                  | 42/1147 [02:57<1:06:07,  3.59s/it]Running ICL inference:   4%|â–ˆâ–                                    | 43/1147 [03:00<59:25,  3.23s/it]Running ICL inference:   4%|â–ˆâ–                                    | 44/1147 [03:02<54:53,  2.99s/it]Running ICL inference:   4%|â–ˆâ–                                    | 45/1147 [03:05<56:02,  3.05s/it]Running ICL inference:   4%|â–ˆâ–Œ                                    | 46/1147 [03:09<58:59,  3.21s/it]Running ICL inference:   4%|â–ˆâ–                                  | 47/1147 [03:21<1:48:41,  5.93s/it]Running ICL inference:   4%|â–ˆâ–Œ                                  | 48/1147 [03:24<1:33:13,  5.09s/it]Running ICL inference:   4%|â–ˆâ–Œ                                  | 49/1147 [03:28<1:24:20,  4.61s/it]Running ICL inference:   4%|â–ˆâ–Œ                                  | 50/1147 [03:31<1:15:42,  4.14s/it]Running ICL inference:   4%|â–ˆâ–Œ                                  | 51/1147 [03:33<1:07:51,  3.71s/it]Running ICL inference:   5%|â–ˆâ–‹                                  | 52/1147 [03:43<1:40:06,  5.49s/it]Running ICL inference:   5%|â–ˆâ–‹                                  | 53/1147 [03:50<1:49:55,  6.03s/it]Running ICL inference:   5%|â–ˆâ–‹                                  | 54/1147 [03:54<1:37:43,  5.36s/it]Running ICL inference:   5%|â–ˆâ–‹                                  | 55/1147 [03:57<1:23:24,  4.58s/it]Running ICL inference:   5%|â–ˆâ–Š                                  | 56/1147 [04:01<1:18:29,  4.32s/it]Running ICL inference:   5%|â–ˆâ–Š                                  | 57/1147 [04:05<1:17:36,  4.27s/it]Running ICL inference:   5%|â–ˆâ–Š                                  | 58/1147 [04:07<1:09:01,  3.80s/it]Running ICL inference:   5%|â–ˆâ–Š                                  | 59/1147 [04:12<1:13:17,  4.04s/it]Running ICL inference:   5%|â–ˆâ–‰                                  | 60/1147 [04:15<1:09:00,  3.81s/it]Running ICL inference:   5%|â–ˆâ–‰                                  | 61/1147 [04:20<1:13:28,  4.06s/it]Running ICL inference:   5%|â–ˆâ–‰                                  | 62/1147 [04:25<1:15:46,  4.19s/it]Running ICL inference:   5%|â–ˆâ–‰                                  | 63/1147 [04:27<1:06:58,  3.71s/it]Running ICL inference:   6%|â–ˆâ–ˆ                                  | 64/1147 [04:32<1:11:38,  3.97s/it]Running ICL inference:   6%|â–ˆâ–ˆ                                  | 65/1147 [04:35<1:06:02,  3.66s/it]Running ICL inference:   6%|â–ˆâ–ˆ                                  | 66/1147 [04:47<1:51:56,  6.21s/it]Running ICL inference:   6%|â–ˆâ–ˆ                                  | 67/1147 [04:51<1:40:37,  5.59s/it]Running ICL inference:   6%|â–ˆâ–ˆâ–                                 | 68/1147 [04:54<1:27:54,  4.89s/it]Running ICL inference:   6%|â–ˆâ–ˆâ–                                 | 69/1147 [05:07<2:08:22,  7.14s/it]Running ICL inference:   6%|â–ˆâ–ˆâ–                                 | 70/1147 [05:09<1:44:30,  5.82s/it]Running ICL inference:   6%|â–ˆâ–ˆâ–                                 | 71/1147 [05:12<1:29:35,  5.00s/it]Running ICL inference:   6%|â–ˆâ–ˆâ–Ž                                 | 72/1147 [05:16<1:19:33,  4.44s/it]Running ICL inference:   6%|â–ˆâ–ˆâ–Ž                                 | 73/1147 [05:18<1:08:17,  3.81s/it]Running ICL inference:   6%|â–ˆâ–ˆâ–Ž                                 | 74/1147 [05:31<1:57:52,  6.59s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–Ž                                 | 75/1147 [05:43<2:27:18,  8.24s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–                                 | 76/1147 [05:53<2:35:47,  8.73s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–                                 | 77/1147 [05:57<2:11:26,  7.37s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–                                 | 78/1147 [06:04<2:08:11,  7.20s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–                                 | 79/1147 [06:07<1:47:12,  6.02s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–Œ                                 | 80/1147 [06:19<2:19:34,  7.85s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–Œ                                 | 81/1147 [06:24<2:04:13,  6.99s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–Œ                                 | 82/1147 [06:34<2:19:45,  7.87s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–Œ                                 | 83/1147 [06:37<1:50:00,  6.20s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–‹                                 | 84/1147 [06:39<1:29:27,  5.05s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–‹                                 | 85/1147 [06:41<1:15:40,  4.28s/it]Running ICL inference:   7%|â–ˆâ–ˆâ–‹                                 | 86/1147 [06:44<1:09:06,  3.91s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–‹                                 | 87/1147 [06:47<1:02:07,  3.52s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–Š                                 | 88/1147 [06:52<1:08:53,  3.90s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–Š                                 | 89/1147 [06:57<1:15:06,  4.26s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–Š                                 | 90/1147 [07:02<1:18:07,  4.43s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–Š                                 | 91/1147 [07:05<1:09:23,  3.94s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–‰                                 | 92/1147 [07:07<1:03:30,  3.61s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–‰                                 | 93/1147 [07:11<1:05:05,  3.71s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–‰                                 | 94/1147 [07:15<1:06:22,  3.78s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–‰                                 | 95/1147 [07:20<1:13:38,  4.20s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–ˆ                                 | 96/1147 [07:25<1:13:15,  4.18s/it]Running ICL inference:   8%|â–ˆâ–ˆâ–ˆ                                 | 97/1147 [07:37<1:55:34,  6.60s/it]Running ICL inference:   9%|â–ˆâ–ˆâ–ˆ                                 | 98/1147 [07:41<1:40:22,  5.74s/it]Running ICL inference:   9%|â–ˆâ–ˆâ–ˆ                                 | 99/1147 [07:52<2:10:54,  7.49s/it]Running ICL inference:   9%|â–ˆâ–ˆâ–ˆ                                | 100/1147 [07:54<1:43:41,  5.94s/it]Terminated
